function changedata(a){if(""!=a.elem.val()){var e=new FormData;e.append("fromajax","yes"),e.append(a.elem.attr("name"),a.elem.val());var t=$(".msg",a.elem.parent());t.html("Saving..."),$.ajax({type:"POST",url:actionprofile+"/"+a.url,data:e,contentType:!1,processData:!1,dataType:"json",success:function(a){t.html("<span class='text-"+a.data.class+"'>"+a.message+"</span>"),setTimeout(function(){t.html("")},3e3)},error:function(a,e,t){formatErrorMessage(a,e,t)},complete:function(){clearconsole()}})}}$("#form-profil").off("blur","input[name=nama]").on("blur","input[name=nama]",function(a){changedata({url:"ubahnama",elem:$(this)})}),$("#form-profil").off("blur","input[name=email]").on("blur","input[name=email]",function(a){changedata({url:"ubahemail",elem:$(this)})}),$("#form-profil").off("blur","input[name=notelp]").on("blur","input[name=notelp]",function(a){changedata({url:"ubahnotelp",elem:$(this)})}),$("#form-password").on("submit",function(a){a.preventDefault();var e=$(this);if(e.parsley().validate(),e.parsley().isValid()){blockUI();var t=new FormData(e[0]),o=$("button[type=submit]",e),n=o.html();togglesubmit(o,1,"Proses..."),t.append("fromajax","yes"),blockUI(),$.ajax({type:"POST",url:actionprofile+"/ubahsandi",data:t,contentType:!1,processData:!1,dataType:"json",xhr:function(){return customxhr($.ajaxSettings.xhr())},success:function(a){messageBox(a.message,a.status),"success"==a.status&&e[0].reset()},error:function(a,e,t){formatErrorMessage(a,e,t)},complete:function(){unblockUI(),clearconsole(),togglesubmit(o,0,n)}})}}),$("input[name=newfoto]").on("change",function(){blockUI();var a=$("#form-gambar"),e=new FormData(a[0]);e.append("fromajax","yes"),blockUI(),$.ajax({type:"POST",url:actionprofile+"/ubahfoto",data:e,contentType:!1,processData:!1,dataType:"json",xhr:function(){return customxhr($.ajaxSettings.xhr())},success:function(a){messageBox(a.message,a.status),$("#vfoto").html(a.data.foto),$(".user-image").html(a.data.foto)},error:function(a,e,t){formatErrorMessage(a,e,t)},complete:function(){unblockUI(),clearconsole()}})}),$(document).off("click",".btn-delete-foto").on("click",".btn-delete-foto",function(){swal({title:"Yakin ingin menghapus foto anda?",text:"Anda tidak dapat memulihkan foto anda!",icon:"error",buttons:{cancel:{text:"Batal",visible:!0,className:"btn btn-default",closeModal:!0},confirm:{text:"Hapus",visible:!0,className:"btn btn-danger",closeModal:!0}},closeOnClickOutside:!0,dangerMode:!0}).then(function(a){a&&(blockUI(),$.ajax({url:actionprofile+"/deletefoto",type:"POST",data:{fromajax:"yes"},contentType:!1,processData:!1,dataType:"json",xhr:function(){return customxhr($.ajaxSettings.xhr())},success:function(a){$("#vfoto").html(a.data.image),$(".user-image").html(a.data.image),messageBox(a.message,a.status)},error:function(a,e,t){formatErrorMessage(a,e,t)},complete:function(){unblockUI(),clearconsole()}}))})});